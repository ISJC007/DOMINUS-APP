<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dominus - Gesti√≥n de Negocio</title>
    
    <link rel="stylesheet" href="CSS/Styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ffd700">

    <link rel="icon" type="image/png" sizes="192x192" href="IMG/icon-192.png">
    <link rel="apple-touch-icon" href="IMG/icon-192.png">

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
</head>
<body>

    <div id="splash-screen" class="splash">
    <div class="splash-content">
        <h1 class="logo-anim">DOMINUS</h1>
        <p class="slogan-anim">Domina tu negocio, Domina tu vida</p>
        
        <div class="loader"></div>

<div id="contenedor-sabiduria" style="margin-top: 30px; width: 100%; display: flex; flex-direction: column; align-items: center;">
    </div>
                <p id="frase-splash" style="font-style: italic; font-size: 1.1em; color: white; min-height: 3em; line-height: 1.4;">
                "Preparando el ecosistema..."
            </p>
            <p id="autor-splash" style="color: var(--primary); font-weight: bold; margin-top: 10px; text-transform: uppercase; letter-spacing: 2px; font-size: 0.8em;">
                ‚Äî DOMINUS AI
            </p>
        </div>
    </div>

    <div id="panelAjustes" class="ajustes-sidebar">
        <div class="ajustes-header">
            <span>Configuraci√≥n DOMINUS</span>
            <button onclick="Interfaz.toggleAjustes()" style="background:none; border:none; color:white; font-size:24px; cursor:pointer;">√ó</button>
        </div>
        <div class="panel-body" style="padding: 20px;">
            <div class="ajuste-item" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                <span style="color: white; font-weight: 600;">üåô Modo Oscuro</span>
                <label class="switch">
                    <input type="checkbox" id="checkDarkMode" onchange="Controlador.toggleDarkMode(this.checked)">
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="ajuste-item" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                <span style="color: white; font-weight: 600;">üì¶ Control Stock</span>
                <label class="switch">
                    <input type="checkbox" id="check-inv" onchange="Controlador.toggleInv(this.checked)">
                    <span class="slider round"></span>
                </label>
            </div>

            <div class="ajuste-item" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
    <div style="display: flex; flex-direction: column;">
        <span style="color: white; font-weight: 600;">üîê Seguridad PIN</span>
        <small style="color: #888; font-size: 0.75em;">Proteger acceso a la app</small>
    </div>
    <button onclick="Seguridad.prepararCambioPIN()" 
            style="background: var(--primary); border: none; color: black; padding: 8px 12px; border-radius: 5px; font-weight: bold; cursor: pointer; font-size: 0.8em;">
        CAMBIAR
    </button>
</div>
            <hr style="border: 0; border-top: 1px solid #333; margin: 20px 0;">
            <button type="button" class="btn-main" style="background: #ff4444; width: 100%;" onclick="DOMINUS.resetTotal()">
                üóëÔ∏è Limpiar Toda la App
            </button>
        </div>
    </div>

    <header class="main-header glass">
        <div class="header-top" style="display: flex; align-items: center; justify-content: space-between; padding: 15px 20px;">
            <div style="width: 40px;">
                <button onclick="Interfaz.toggleAjustes()" class="btn-ajustes-top" style="background: none; border: none; font-size: 24px; cursor: pointer; color: white;">‚öôÔ∏è</button>
            </div>
            
            <div style="flex-grow: 1; text-align: center;">
                <h1 class="titulo-app" style="margin: 0; font-size: 1.8rem;">DOMINUS</h1>
                <p class="slogan" style="margin: 0; font-size: 0.7rem; opacity: 0.8;">Domina tu negocio, Domina tu vida</p>
            </div>
            <div style="width: 40px;"></div> 
        </div>

        <div class="tasa-control" style="margin-top: 10px; display: flex; justify-content: center; align-items: center; gap: 10px; padding-bottom: 10px;">
            <span style="font-size: 0.9em; opacity: 0.8;">Tasa:</span>
            <input type="number" id="tasa-global" onchange="Conversor.setTasa(this.value)" step="0.1" 
                   style="width: 70px; background: rgba(255,255,255,0.05); border: 1px solid var(--primary); color: white; border-radius: 5px; text-align: center;">
        </div>

        <div class="dashboard-cards">
            <div class="card-mini">
                <small>Caja (Neto)</small>
                <b id="total-caja">0 Bs</b>
                <span id="total-usd">$ 0.00</span>
            </div>
            <div class="card-mini">
                <small>Por Cobrar</small>
                <b id="total-fiaos" style="color: #ff9800;">0 Bs</b>
            </div>
            <div class="card-mini">
                <small>Gastos</small>
                <b id="total-gastos" style="color: #ff5252;">0 Bs</b>
            </div>
        </div>
    </header>

    <nav class="bottom-nav glass">
        <button type="button" onclick="Interfaz.show('dashboard')">üè† Inicio</button>
        <button type="button" onclick="Interfaz.show('ventas')">üí∞ Ventas</button>
        <button type="button" onclick="Interfaz.show('gastos')">üìâ Gastos</button>
        <button type="button" onclick="Interfaz.show('fiaos-list')">ü§ù Cr√©ditos</button>
        <button type="button" onclick="Interfaz.show('inventario')">üì¶ Stock</button>
    </nav>

    <main id="app-content">
        
        <section id="view-dashboard" class="app-section">
            <div class="welcome-card glass">
                <h2>Bienvenido</h2>
                <p>Usa el men√∫ inferior para registrar movimientos.</p>
                <button type="button" class="btn-main" style="margin-top: 20px; background: #2196F3; color: white;" onclick="Controlador.generarCierre()">
                    üìä Generar Cierre del D√≠a
                </button>
            </div>
            <div class="card-grafica">
                <canvas id="graficaVentas"></canvas>
            </div>
        </section>

     <section id="view-ventas" class="app-section hidden">
    <div class="card glass">
        <button type="button" class="btn-main btn-success" 
            style="width:100%; margin-bottom:15px; background:linear-gradient(45deg, #2ecc71, #27ae60); border:none; padding:12px; border-radius:8px; color:white; font-weight:bold; cursor:pointer;" 
            onclick="Interfaz.iniciarEscannerCamara()">
            üì∑ Escanear Producto
        </button>

        <h3>Nueva Venta</h3>

        <button type="button" id="btn-modo-punto" class="glass" 
            onclick="Interfaz.alternarModoPunto()"
            style="width: 100%; padding: 12px; margin-bottom: 10px; border: 1px dashed var(--primary); color: var(--primary); font-weight: bold; cursor: pointer; border-radius: 8px;">
            üè¶ ¬øEs Servicio de Punto?
        </button>

        <div id="wrapper-comision" class="hidden">
            <label for="v-comision">Comisi√≥n %:</label>
            <input type="number" id="v-comision" name="v-comision" placeholder="Comisi√≥n %" style="margin-bottom: 5px;">
            <div class="comision-selector" style="display: flex; gap: 5px; margin-bottom: 10px;">
                <button type="button" class="btn-mini" onclick="document.getElementById('v-comision').value=5">5%</button>
                <button type="button" class="btn-mini" onclick="document.getElementById('v-comision').value=10">10%</button>
                <button type="button" class="btn-mini" onclick="document.getElementById('v-comision').value=15">15%</button>
                <button type="button" class="btn-mini" style="background:#607d8b" onclick="document.getElementById('v-comision').value=0">0%</button>
            </div>
        </div>

        <label for="v-producto">Producto:</label>
        <input type="text" id="v-producto" name="v-producto" list="sugerencias-ventas" oninput="Interfaz.actualizarSelectorTallas(this.value)" placeholder="(Ej: Pollo)">
        <datalist id="sugerencias-ventas"></datalist>

        <label for="v-cantidad">Cantidad:</label>
        <input type="number" id="v-cantidad" name="v-cantidad" placeholder="Cantidad" value="1" style="margin-bottom: 10px;">

        <div id="contenedor-talla" class="hidden" style="margin-bottom: 10px;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                <label for="v-talla" style="color: var(--primary); font-size: 0.9em;">Seleccione Talla/Peso:</label>
            </div>
            <select id="v-talla" name="v-talla" class="glass" 
                    style="width: 100%; padding: 10px; border-radius: 8px; background: #222; color: white; border: 1px solid var(--primary);"
                    onchange="Controlador.mostrarStockDisponible(this.value)"> 
                <option value="">Seleccione Talla...</option>
            </select>
        </div>

        <div class="input-group">
            <div style="flex:2">
                <label for="v-monto">Monto:</label>
                <input type="number" id="v-monto" name="v-monto" placeholder="Monto">
            </div>
            <div style="flex:1">
                <label for="v-moneda">Moneda:</label>
                <select id="v-moneda" name="v-moneda">
                    <option value="USD">$ USD</option>
                    <option value="BS">Bs</option>
                </select>
            </div>
        </div>
        
        <label for="v-metodo">M√©todo de Pago:</label>
        <select id="v-metodo" name="v-metodo" onchange="Interfaz.toggleClienteField(this.value)">
            <option value="Efectivo $">Efectivo $</option>
            <option value="Pago M√≥vil">Pago M√≥vil</option>
            <option value="Punto de Venta">Punto de Venta</option>
            <option value="Fiao">Fiao (Deuda)</option>
            <option value="Biopago">Biopago</option>
        </select>
        
        <div id="wrapper-cliente" class="hidden">
            <label for="v-cliente">Cliente:</label>
            <input type="text" id="v-cliente" name="v-cliente" placeholder="Nombre del Cliente">
        </div>

        <button type="button" class="btn-main" onclick="Controlador.ejecutarVenta()">Registrar Venta</button>
    </div> <h4>√öltimas Ventas</h4>
    <div id="lista-ventas-historial" class="listado-container"></div>
</section>

        <section id="view-gastos" class="app-section hidden">
            <div class="card glass">
                <h3>Registrar Gasto</h3>
                <label for="g-desc">Descripci√≥n:</label>
                <input type="text" id="g-desc" name="g-desc" placeholder="¬øEn qu√© gastaste?">
                <div class="input-group">
                    <div style="flex:2">
                        <label for="g-monto">Monto:</label>
                        <input type="number" id="g-monto" name="g-monto" placeholder="Monto">
                    </div>
                    <div style="flex:1">
                        <label for="g-moneda">Moneda:</label>
                        <select id="g-moneda" name="g-moneda">
                            <option value="USD">$ USD</option>
                            <option value="BS">Bs</option>
                        </select>
                    </div>
                </div>
                <button type="button" class="btn-main btn-danger" onclick="Controlador.ejecutarGasto()">Guardar Gasto</button>
            </div>
            <h4>Historial de Gastos</h4>
            <div id="lista-gastos-historial" class="listado-container"></div>
        </section>

        <section id="view-fiaos-list" class="app-section hidden">
            <h3>Cuentas por Cobrar (Bs)</h3>
            <div id="lista-fiaos" class="listado-container"></div>
        </section>

       <section id="view-inventario" class="app-section hidden" style="overflow-x: hidden;">
    <div class="card glass">
        <h3>üì¶ Cargar Inventario</h3>
        
        <fieldset style="border: 1px solid #444; border-radius: 10px; padding: 10px; margin-bottom: 15px;">
            <legend style="color: var(--primary); padding: 0 5px;">Datos del Producto</legend>
            
            <label for="inv-nombre">Producto:</label>
            <input type="text" id="inv-nombre" name="inv-nombre" placeholder="Camisa..." style="width: 100%; box-sizing: border-box; margin-bottom: 10px;">
            
            <div style="display: flex; gap: 10px; flex-wrap: wrap; width: 100%; box-sizing: border-box;">
                <div style="flex: 1; min-width: 120px;"> 
                    <label for="inv-cant">Cantidad Total:</label>
                    <input type="number" id="inv-cant" name="inv-cant" placeholder="0" min="0" style="width: 100%; box-sizing: border-box;">
                </div>
                <div style="flex: 1; min-width: 120px;">
                    <label for="inv-precio">Precio de Venta:</label>
                    <input type="number" id="inv-precio" name="inv-precio" placeholder="$0.00" min="0" step="0.01" style="width: 100%; box-sizing: border-box;">
                </div>
            </div>
        </fieldset>

        <label for="inv-unidad">Unidad de Medida / Tipo:</label>
        <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 15px;">
            <select id="inv-unidad" name="inv-unidad" class="glass" style="flex: 2; padding: 10px; color: white; background: #222; box-sizing: border-box;">
                <option value="Und">Unidad (Und)</option>
                <option value="Paca">Paca (Paq)</option>
                <option value="Kg">Kilogramos (Kg)</option>
                <option value="Lts">Litros (Lts)</option>
                <option value="Talla">Talla (Ropa/Calzado)</option>
            </select>
            
            <button type="button" class="btn-mini" style="background:#444; flex: 1; padding: 10px; font-size: 0.9em;" onclick="AbrirGestorTallas()">
                 ‚öôÔ∏è Desglosar
            </button>
        </div>

        <button type="button" class="btn-main" onclick="Controlador.guardarEnInventario()">Cargar Producto</button>
    </div>

    <div style="margin: 25px 15px 0 15px;"> 
        <h4 style="margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
    Stock Actual 
    <button type="button" class="btn-mini" style="background:var(--primary); color:black; padding: 5px 10px;" 
            onclick="Interfaz.mostrarSelectorEscaner()">
        üì∑ Escanear
    </button>
</h4>
        
        <div class="search-box glass" style="margin-bottom: 15px; position: sticky; top: 0; z-index: 5; box-sizing: border-box;">
            <input type="text" id="busqueda-real-inv" placeholder="üîç Buscar producto..." 
                   style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid var(--primary); background: rgba(0,0,0,0.3); color: white; font-size: 1em; box-sizing: border-box;">
        </div>

        <div id="contenedor-camara" style="display:none; width: 100%; height: 300px; margin-bottom: 15px; border-radius: 10px; overflow: hidden;"></div>

        <div id="lista-inventario" class="listado-container" style="width: 100%; overflow-x: hidden;"></div>
    </div>
</section>

<div id="modal-gestor-tallas" class="modal-tallas">
    <div class="modal-content-tallas glass">
        <h3 style="color:var(--primary); margin-bottom:15px;">‚öôÔ∏è Desglose Por Tipo</h3>
        
        <div id="contenedor-filas-tallas"></div>
        
        <button type="button" class="btn-main" style="margin-top:15px;" onclick="CerrarGestorTallas()">Confirmar Cantidades</button>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.rawgit.com/serratus/quaggaJS/0420d5e/dist/quagga.min.js"></script>

<script src="JS/frases.js"></script>
<script src="JS/Offline.js"></script>
<script src="JS/Seguridad.js"></script> <script src="JS/Servicios.js"></script>
<script src="JS/Conversor.js"></script>
<script src="JS/Inventario.js"></script>

<script src="JS/Ventas.js"></script> 
<script src="JS/Main.js"></script>

<script>
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./sw.js');
    }
</script>

</body>
</html>
